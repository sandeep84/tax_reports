{% macro account_table(account_list, level) -%}
        {% for account in account_list %}
        <tbody class="labels">
        <tr>
            <td colspan="2">
                <label for="{{ account["name"] }}">{{ account["name"] }}</label>
                <input type="checkbox" name="{{ account["name"] }}" id="{{ account["name"] }}" data-toggle="toggle">
            </td>
            <td>{% if account["value"] != 0 %}{{ account["value"] }}{% endif %}</td>
            <td>{% if account["sub_total"] != 0 %}{{ account["sub_total"] }}{% endif %}</td>
        </tr>
        </tbody>
        {% if account["splits"]|length > 0 %}
        <tbody class="hide">
                {% for split in account["splits"] %}
                <tr>
                    <td width="100px">{{split["date"]}}</td>
                    <td>{{split["description"]}}</td>
                    <td>{{split["value"]}}</td>
                    <td></td>
                </tr>
                {% endfor %}
        </tbody>
        {% endif %}

        {% if account["children"]|length > 0 %}
            {{ account_table(account["children"], level+1) }}
        {% endif %}
    {% endfor %}
{%- endmacro %}


<html>

<head>
    <title>Test</title>
    <link rel="stylesheet" href="tax_report.css"/>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script type="text/javascript">
        $(document).ready(function() {
	        $('[data-toggle="toggle"]').change(function() {
		        $(this).parents().next('.hide').toggle();
            });
        });
    </script>
</head>

<body>
    <h2>Income</h2>
    {% for account in summary %}
        <h3>{{ account["name"] }}</h3>
        {% if account["children"]|length > 0 %}
        <table class="styled-table">
            <thead>
                <tr>
                    <th colspan="2">Description</th>
                    <th>Value</th>
                    <th>Sub-total</th>
                </tr>
            </thead>
            <tbody>
                {{ account_table(account["children"], 1) }}
            </tbody>
        </table>
        {% endif %}
    {% endfor %}
</body>

</html>